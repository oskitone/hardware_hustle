import classnames from "classnames";

import styles from "@/styles/Rules.module.css";

import { ID_TITLE } from "components/sidebar";
import ActionsTable, { ACTIONS } from "components/actions-table";
import Icon, {
  Money,
  Opportunity,
  A,
  B,
  C,
  D,
  AB,
  ABC,
  ABCD,
  Roll,
} from "components/icon";
import Turn, { firstTurnSuppliedColumns } from "components/turn";
import Wordmark from "components/wordmark";

<Wordmark className={styles.Wordmark} draftId={props.draftId} />

# Rules

## Introduction

{/* Conceptual intro */}

Buy, make, sell, and research your way to profit without burning out!

## Overview

Hardware Hustle is a roll-and-write resource management game for one or more players about sustainably running a small hardware business.

You have six turns to make as much money as you can by buying parts, making widgets, and then selling the widgets for profit. Along the way, you can get better at those actions by researching. But don't overwork yourself or you'll burn out and lose a turn!

## Components

Each player will need:

- Hardware Hustle game sheet
- Six-sided die or "Roll Table" sheet
- Calculator or scratch paper for math (optional)

## Game Setup

The player with the highest die roll goes first, then proceed clockwise.

Fill out the "{ID_TITLE}" line in the game sheet's top left, then familiarize yourself with the Actions table below it.

{/* TODO: rough outline of worksheet? */}

<ActionsTable className={styles.ActionsTable} />

Its icons represent:

{/* TODO: table or some nice way to show these? */}

- Parts
  - <A />: Enclosure
  - <B />: Speaker
  - <C />: Controls
  - <D />: Processor
- Widgets
  - <AB />: Amplifier
  - <ABC />: Noisebox
  - <ABCD />: Synth
- <Money />: Money
- <Opportunity />: Opportunity
- <Roll />: Dice roll

## How to Play

The game is played in six turns, each represented as a miniature spreadsheet. The spreadsheet's rows are grouped into Money, parts, widgets, and Opportunity; its columns are actions to be filled out from left to right.

1. ### AM
   Wake up and get ready for the day
1. ### Buy
   Buy parts (<A /> <B /> <C /> <D />) using <Opportunity /> and <Money />
1. ### Make
   Make widgets (<AB /> <ABC /> <ABCD />) using <Opportunity /> and parts
1. ### Sell
   Sell widgets to get <Money />, using <Opportunity />
1. ### PM
   End your workday; use remaining <Opportunity /> to attempt Research, or lose next turn if <Opportunity /> is negative

Let's walk through each action in detail:

### 1. AM

You start your turn like a typical workday, waking up in the AM.

For the game's first turn, there's nothing to do here besides note your starting values: 10 <Money />, 12 <Opportunity />, and nothing else.

### 2. Buy

Time to get to work and buy some parts.

{/* TODO: would these look nice as a table? */}

1. **Roll:** Roll a die. Its value is the _maximum_ you can spend on Opportunity.
1. **Decide:** Based on how much <Money /> you have in the AM column and max <Opportunity /> you just rolled, decide which parts you'd like to buy. See below.
1. **Write:** In the Buy column, write the values for the parts you bought and their total <Opportunity /> and <Money /> costs.

Refer to the Actions table for costs:

<ActionsTable actions={[ACTIONS.BUY]} className={styles.ActionsTable} />

The <Opportunity /> costs are a table of values, but, for now, you'll only use the ones in the first column with the dark outline. In other words, a <A /> costs 0 <Opportunity /> + 1 <Money />, a <B /> costs 1 <Opportunity /> + 2 <Money />, etc.

You can buy as much as you want, as long as the total <Opportunity /> sum is less than or equal to your roll and you have the <Money />.

Note:

- Cells are prefixed by their mathematical operation. We're spending <Money /> and <Opportunity />, so those they have a "**-**". We're gaining parts, so those cells have a "**+**". You can see the same corresponding **-**/**+** signs in the Actions table.
- Unused cells have a gray background so we know to skip them.
- Cells with no change can be crossed out or filled with 0.
- You can spend less <Opportunity /> than you roll, but you cannot spend more.
- You also cannot spend more Money than you have.

### 3. Make

Next, you'll use those parts to Make widgets.

1. **Roll:** Roll a die. Its value is the _maximum_ you can spend on Opportunity.
1. **Decide:** Based on which parts you bought in the previous turn and max <Opportunity /> you just rolled, decide which widgets you'd like to make.
1. **Write:** In the Make column, write the values for the parts you used and their total <Opportunity /> and cost.

<ActionsTable actions={[ACTIONS.MAKE]} className={styles.ActionsTable} />

Again, only use outlined values for now.

### 4. Sell

If you made any widgets, now's the time to sell them.

1. **Roll for <Opportunity />:** Roll a die. Its value is the maximum you can spend on Opportunity.
1. **Decide:** Based on which widgets you made in the previous turn and max <Opportunity /> you just rolled, decide which widgets you'd like to sell.
1. **Write:** In the Sell column, write the values for the widgets you sold and their total <Opportunity /> and cost.

<ActionsTable actions={[ACTIONS.MAKE]} className={styles.ActionsTable} />

### 5. PM

The cells in the PM column are all prefixed with **=**. Let's finish those equations to close out the spreadsheet and end the turn.

1. **Tally:** Complete each row's math equation into the final column.
1. **Resolve <Opportunity />:**
   - If <Opportunity /> is negative, you suffer **Burnout** and lose the entire next turn to rest.
   - Otherwise, **Roll for Research**. Its value is the <Opportunity /> cost to research getting better at _one_ of the previous three actions: Buying, Making, or Selling.
1. **Plot:** Draw a dot on the "Money / Turn" chart at your new <Money /> total, then draw a line connecting it to the previous dot.

#### Burnout

Cross out the entire next turn's spreadsheet. You cannot do any of its actions.

#### Research

Did you roll less than or equal to your remaining <Opportunity />? Congrats! Your research succeeded. Circle the cell to mark that your research succeeded; otherwise cross it out to say it failed.

{/* TODO: circle/cross examples */}

Remember how you've only been using the first column of <Opportunity /> values with the dark outline? If your research succeeded, choose _one_ action to spend it on, then cross its column out to outline the values to their right. As an example, here's what it would look like to successfully research Making:

<ActionsTable className={styles.ActionsTable} selectedIndexes={[0, 1, 0]} />

Note that the other action's <Opportunity /> costs are unchanged.

### Example turn

{/* TODO: turn a profit, successful research w/ circle */}

<Turn
  className={styles.Turn}
  data={{
    money: [10, 9, undefined, 6, 7],
    A: [0, 2, 2, undefined, 0],
    B: [0, 2, 2, undefined, 0],
    C: [0, 1, 1, undefined, 0],
    D: [0, 0, 0, undefined, 0],
    AB: [0, undefined, 1, 1, 0],
    ABC: [0, undefined, 1, 0, 1],
    ABCD: [0, undefined, 0, 0, 0],
    opportunity: [12, 4, 3, 2, 3],
  }}
  suppliedColumns={firstTurnSuppliedColumns}
/>

## Ending a turn

When your turn's done, hand the die to the next player so they can start theirs.

## Starting a new turn

The values in your PM column carry over to the empty cells in the next turn's AM column, as denoted by their "**â‡¢**" prefix.

Note that <Opportunity /> is _not_ empty; you have to use the value provided.

## End of the Game

The player with the most money at the end of the six turns _without_ Burning Out in the last turn wins! Unused parts and unsold widgets count for nothing, only Money.

If you **Burnout** in the last turn, you automatically lose.

{/* TODO: reconsider or houserule */}

## Solo Mode

Solo play is solitaire; try to beat your best score.

{/* ## TODO Credits */}

---

_{props.draftId}_  
_{props.year} CC BY-SA 4.0 - oskitone.com_

export default function Rules({ children, page, pageCount, year, draftId }) {
  return (
    <div className={
        classnames(
          styles.rules, {
            [styles["view-all"]]: page == undefined
          }
        )
    }>
      <div className={classnames(styles.pageNumber, {
        [styles.front]: page % 2 == 0,
        [styles.back]: page % 2 == 1
      })}>{page + 1}/{pageCount}</div>
      <div className={styles.inner} page={page}>
        {children}
      </div>
    </div>
  );

}
