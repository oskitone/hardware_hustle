import classnames from "classnames";

import styles from "@/styles/Rules.module.css";

import { ID_TITLE } from "components/sidebar";
import ActionsTable, { ACTIONS } from "components/actions-table";
import Icon, {
  Money,
  Opportunity,
  A,
  B,
  C,
  D,
  AB,
  ABC,
  ABCD,
  Roll,
  MoneyX,
  OpportunityX,
  AX,
  BX,
  CX,
  DX,
  ABX,
  ABCX,
  ABCDX,
  RollX,
  IconsParen
} from "components/icon";
import Turn, { ExampleCell, firstTurnSuppliedColumns } from "components/turn";
import Wordmark from "components/wordmark";

<Wordmark className={styles.Wordmark} draftId={props.draftId} />

{/* TODO: standardize "the total <Opportunity /> they cost" language. Consumed? Used? */}

# Rules

## Introduction

Hardware Hustle is a tabletop, roll-and-write resource management game about sustainably running a small hardware business.

For 1+ players. Ages 10+. ~20min to play.

## Game Overview

You have six turns to buy parts to make widgets, make widgets from parts, and then sell widgets for money to buy more parts.

Each of those actions takes opportunity <IconsParen ids={["opportunity"]} />, which depletes as the game progresses. At the end of each turn, you can attempt a research upgrade to reduce future <Opportunity /> costs.

The six turns are miniature spreadsheets, and the game ends when they're all filled out. The player at the end with the most money wins.

## Components

Each player will need:

- Hardware Hustle game sheet
- Six-sided die or "Roll Table" sheet
- Calculator or scratch paper for math (optional)

## Game Setup

Fill out the "{ID_TITLE}" line in the top left of the game sheet, then familiarize yourself with the rest of its layout: Phases table, Money/Turn graph, and six turn spreadsheets.

![Hardware Hustle game sheet layout](../screenshot.png)

The player who rolls the second highest die goes first, then proceed clockwise.

## How to Play

The spreadsheet's rows are grouped into money <IconsParen ids={["money"]} />, parts <IconsParen ids={["A", "B", "C", "D"]} />, widgets <IconsParen ids={["AB", "ABC", "ABCD"]} />, and opportunity <IconsParen ids={["opportunity"]} />.

Its five columns are phases that you fill out from left to right during your turn.

1. ### AM
   Take stock of what you have and need
1. ### Buy
   Buy parts <IconsParen ids={["A", "B", "C", "D"]} /> using <Money /> and <Opportunity />
1. ### Make
   Make widgets <IconsParen ids={["AB", "ABC", "ABCD"]} /> using parts and <Opportunity />
1. ### Sell
   Sell widgets for <Money /> using <Opportunity />
1. ### PM
   Use remaining <Opportunity /> to research or lose next turn if <Opportunity /> is negative

{/* TODO: try pulling these to front. */}
(See *Example Turn* near the end of these rules for a succinct walkthrough of what a completed first turn might look like and an *Icon Glossary* to explain what the icons are.)

### 1. AM

You begin each turn by taking stock of what you have and what you need at the beginning of the day.

For the game's first turn, there's nothing to do here besides note the starting pre-filled values. You have <MoneyX value={10}/> and <OpportunityX value={12}/>, and you need basically everything else.

(Later turns will have empty cells to fill out, but there still won't be any decision-making. For that reason, AM is not listed in the Phases table on the left of your game sheet.)

### 2. Buy

Let's buy some parts. They cost <Money /> and <Opportunity />, as listed in the Phases table:

<ActionsTable actions={[ACTIONS.BUY]} className={styles.ActionsTable} />

The <Opportunity /> costs are a table of values, but, for all the phases of your first turn, you'll only use the ones in the first column with the dark outline. To buy a <A />, you need <OpportunityX value={0} /> and <MoneyX value={1} />; to buy a <B /> you need <OpportunityX value={1} /> and <MoneyX value={2} />; etc. You'll revisit <Opportunity /> costs in the PM phase a little later.

To complete the Buy phase:

1. **Roll:**
    * Roll a die. Its value is the _maximum_ <Opportunity /> you can spend buying this turn.
    * Based on the max <Opportunity /> you just rolled and how much <Money /> you have in the AM column, decide which parts to buy.
1. **Write:** In the Buy column, write the values for the total <Money /> cost, the parts you bought, and the total <Opportunity /> they used.

Notes:

- You can buy as many or as few parts as you want and even multiples of the same part, as long as you have the required <Opportunity /> and <Money />. (The sum <Opportunity /> must be less than or equal to your roll, and the sum <Money /> must be less than or equal to what you have in the AM column.)
- You can also choose to buy nothing and skip this phase, though that's a gutsy move on your first turn!
- Cells are prefixed by their mathematical operation. You're losing <Money /> and <Opportunity />, so those cells have a **-**. You're gaining parts, so they have a **+**. The same **-**/**+** signs are in the Phases table.
- Unused cells have a gray background to mark that they're skipped.
- Cells with no change can be crossed out or filled with 0.
- You can spend less <Opportunity /> than you roll, but you can't spend more. You also can't spend more <Money /> than you have available.

### 3. Make

Next, you'll use the parts you've bought to make widgets. The Phases table lists what you can make, their outlined <Opportunity /> costs, and the parts that they'll use:

<ActionsTable actions={[ACTIONS.MAKE]} className={styles.ActionsTable} />

To complete the Make phase:

1. **Roll:**
    * Roll a die. Its value is the _maximum_ <Opportunity /> you can spend making this turn.
    * Based on the max <Opportunity /> you just rolled and which parts you have available, decide which widgets to make.
1. **Write:** In the Make column, write the values for the parts you used, the widgets you made, and the total <Opportunity /> they used.

You can make as many or as few widgets as you want, provided you have the required parts and <Opportunity />. In later turns, you can use parts purchased in previous turns.

### 4. Sell

{/* TODO: no/fewer "note"s */}

If you have any widgets, now's a fine time to sell them. Note how the Phases table has you losing widgets but gaining <Money />:

<ActionsTable actions={[ACTIONS.SELL]} className={styles.ActionsTable} />

To complete the Sell phase:

1. **Roll:**
    * Roll a die. Its value is the _maximum_ <Opportunity /> you can spend selling this turn.
    * Based on the max <Opportunity /> you just rolled and which widgets you have available, decide which widgets to sell.
1. **Write:** In the Sell column, write the values for the <Money /> you made, the widgets you sold, and the total <Opportunity /> they used.

Sell as many or as few widgets as you want, provided you have the required widgets and <Opportunity />. In later turns, you can sell widgets made in previous turns.

### 5. PM

Whew! It's time to wrap up your workday and end your turn.

To complete the PM phase:

1. **Tally:** Complete each row's equation into the final column prefixed with **=**.
1. **Resolve <Opportunity />:**
   - If <Opportunity /> is negative, you suffer **burnout** and lose the entire next turn to rest.
   - Otherwise, **roll for research upgrade**. Its value is the <Opportunity /> cost it would take to upgrade _one_ of the previous three phases' actions.
1. **Plot:** Draw a dot on the "Money/Turn" graph at your new <Money /> total, then draw a line connecting it to the previous dot.

#### Burnout

You've spent more <Opportunity /> than you had available and have to spend the whole next day recuperating. Hope it was worth it.

Cross out the entire next turn's spreadsheet. You cannot do any of its phases.

#### Research Upgrade

Did you roll less than or equal to your remaining <Opportunity />? Nice! Your research succeeded. Circle the PM column's <Opportunity /> cell to mark its success; otherwise cross it out for failure:

<table>
  <tbody>
    <tr>
      <th>Success: &nbsp;</th>
      <td><ExampleCell success value={5} /></td>
    </tr>
    <tr>
      <th>Failure: &nbsp;</th>
      <td><ExampleCell fail value={2} /></td>
    </tr>
  </tbody>
</table>

Recall how you've only been using the first column of <Opportunity /> values with the dark outline in the Phases table. If your research upgrade was successful, choose _one_ phase action (Buy, Make, or Sell) to spend it on, then shade in its outlined column and outline the next values to its right.

As an example, here's what it would look like after a successful research upgrade to Make:

<ActionsTable className={styles.ActionsTable} selectedIndexes={[0, 1, 0]} />

Everything in Make is now <OpportunityX value={1} /> cheaper. The non-researched action's <Opportunity /> costs in Buy and Sell remain unchanged.

Notes:

* PM's <Opportunity /> roll for research upgrade is used differently than the <Opportunity /> roll in the other phases. For Buy/Make/Sell, it's a maximum that you want to roll high; for research, it's a minimum that you want to roll low.
* Because you can't roll higher than six, ending a turn with <OpportunityX value={6} /> or higher means your research attempt automatically wins.
* Subsequent research upgrades on the same phase action work the same way. Each phase action can be upgraded three times.

## Example turn

<Turn
  className={styles.Turn}
  data={{
    money: [10, 5, undefined, 6, 11],
    A: [0, 1, 1, undefined, 0],
    B: [0, 2, 1, undefined, 1],
    C: [0, 0, 0, undefined, 0],
    D: [0, 0, 0, undefined, 0],
    AB: [0, undefined, 1, 1, 0],
    ABC: [0, undefined, 0, 0, 0],
    ABCD: [0, undefined, 0, 0, 0],
    opportunity: [12, 2, 1, 2, 8],
  }}
  suppliedColumns={firstTurnSuppliedColumns}
  researchSuccess={true}
/>

1. ##### AM  
    Started with <MoneyX value={10} /> and <OpportunityX value={12} />
1. ##### Buy  
    Spent <MoneyX value={5} /> to buy <AX value={1} /> and <BX value={2} /> using <OpportunityX value={2} />
1. ##### Make  
    Made <ABX value={1} /> using <AX value={1} />, <BX value={1} />, and <OpportunityX value={1} />
1. ##### Sell  
    Sold <ABX value={1} /> for <MoneyX value={6} /> using <OpportunityX value={2} />
1. ##### PM  
    Ended with <MoneyX value={11} />, <BX value={2} />, and <OpportunityX value={8} />, which was enough for a successful research upgrade

## Ending a turn

When your turn is done, hand the die to the next player so they can start their turn.

## Starting a new turn

The values in the PM column carry over to the empty cells in the next turn's AM column, as denoted by the **⇢** prefix.

The <Opportunity /> cells, however, are _not_ empty; you have to use the values provided.

For skipped turns, fill the **⇢** AM cells on the next playable turn from the PM cells in the previously played turn.

## End of the Game

The player at the end with the most money wins. Unused parts and unsold widgets count for nothing, only money. In the case of a tie, the player with the fewest burnouts wins.

## Solo Mode

Solo play is solitaire. Beat your best score.

## Icon Glossary

{/* TODO: bigger icons? */}

##### Parts

<dl>
  <div><dd><Icon id={"A"} /></dd><dt>Enclosure</dt></div>
  <div><dd><Icon id={"B"} /></dd><dt>Speaker</dt></div>
  <div><dd><Icon id={"C"} /></dd><dt>Controls</dt></div>
  <div><dd><Icon id={"D"} /></dd><dt>Processor</dt></div>
</dl>

##### Widgets

<dl>
  <div><dd><Icon id={"AB"} /></dd><dt>Amplifier</dt></div>
  <div><dd><Icon id={"ABC"} /></dd><dt>Noisebox</dt></div>
  <div><dd><Icon id={"ABCD"} /></dd><dt>Synth</dt></div>
</dl>

##### Other

<dl>
  <div><dd><Icon id={"money"} /></dd><dt>Money</dt></div>
  <div><dd><Icon id={"opportunity"} /></dd><dt>Opportunity</dt></div>
  <div><dd><Icon id={"roll"} /></dd><dt>Roll</dt></div>
</dl>

## Credits

Hardware Hustle was designed by Oskitone, maker of DIY electronic musical instruments and soldering kits. Please consider buying your next synthesizer project from oskitone.com.

This game is published under a CC BY-SA 4.0 license. Find its source code at github.com/oskitone/hardware_hustle

---

_{props.draftId}_  
_{props.year} CC BY-SA 4.0 - oskitone.com_

export default function Rules({ children, page, pageCount, year, draftId }) {
  return (
    <div className={
        classnames(
          styles.rules, {
            [styles["view-all"]]: page == undefined
          }
        )
    }>
      <div className={classnames(styles.pageNumber, {
        [styles.front]: page % 2 == 0,
        [styles.back]: page % 2 == 1
      })}>{page + 1}/{pageCount}</div>
      <div className={styles.inner} page={page}>
        {children}
      </div>
    </div>
  );

}
