import classnames from "classnames";

import styles from "@/styles/Rules.module.css";

import { ID_TITLE } from "components/sidebar";
import ActionsTable, { ACTIONS } from "components/actions-table";
import Icon, {
  Money,
  Opportunity,
  A,
  B,
  C,
  D,
  AB,
  ABC,
  ABCD,
  Roll,
  MoneyX,
  OpportunityX,
} from "components/icon";
import Turn, { firstTurnSuppliedColumns } from "components/turn";
import Wordmark from "components/wordmark";

<Wordmark className={styles.Wordmark} draftId={props.draftId} />

{/* TODO: standardize "the total <Opportunity /> they cost" language. Consumed? Used? */}

{/* TODO: standardize intro w/ readme */}

# Rules

## Introduction

Hardware Hustle is a tabletop, roll-and-write resource management game for one or more players about sustainably running a small hardware business.

Can you buy, make, sell, and research your way to profit without burning out?

## Game Overview

You have six turns to buy parts to make widgets, make widgets from parts, and sell widgets for money.

Each of those actions takes opportunity (<Opportunity />), which you have less and less of as the game progresses. At the end of each turn, you can spend excess <Opportunity /> to attempt a research upgrade, reducing future <Opportunity /> costs for buying, making, or selling.

The six turns are represented as spreadsheets. The game ends when they're all filled out, and the player with the most money wins.

## Components

Each player needs:

- Hardware Hustle game sheet
- Six-sided die or "Roll Table" sheet
- Calculator or scratch paper for math (optional)

## Game Setup

Fill out the "{ID_TITLE}" line in the game sheet's top left. The player with the highest die roll goes first, then proceed clockwise.

## How to Play

The game is played in six turns, each represented as a mini spreadsheet.

The spreadsheet's rows are grouped into money, parts, widgets, and opportunity; its columns are actions to be filled out from left to right.

{/* TODO: labeled graphic */}

1. ### AM
   Wake up and get ready for the day
1. ### Buy
   Buy parts (<A /> <B /> <C /> <D />) using <Opportunity /> and <Money />
1. ### Make
   Make widgets (<AB /> <ABC /> <ABCD />) using <Opportunity /> and parts
1. ### Sell
   Sell widgets to get <Money />, using <Opportunity />
1. ### PM
   End your workday; use remaining <Opportunity /> to attempt research upgrade, or lose next turn if <Opportunity /> is negative

Let's walk through each action in detail:

### 1. AM

Good morning! You start each turn taking stock of what you have and what you need.

For the game's first turn, there's nothing to do here besides note your starting values: <MoneyX value={10}/>, <OpportunityX value={12}/>, and 0 everything else.

### 2. Buy

Let's buy some parts. They cost <Money /> and <Opportunity />, as listed out in the Actions table on the left side of the game sheet:

<ActionsTable actions={[ACTIONS.BUY]} className={styles.ActionsTable} />

The <Opportunity /> costs are a table of values, but, for now, you'll only use the ones in the first column with the dark outline. In other words, to buy a <A /> you need <OpportunityX value={0} /> and <MoneyX value={1} />, to buy a <B /> you need <OpportunityX value={1} /> and <MoneyX value={2} />, etc:

To complete the Buy phase:

1. **Roll for <Opportunity />:** Roll a die. Its value is the _maximum_ <Opportunity /> you can spend buying.
1. **Decide:** Based on how much <Money /> you have in the AM column and the max <Opportunity /> you just rolled, decide which parts to buy.
1. **Write:** In the Buy column, write the values for the total <Money /> cost, the parts you bought, and the total <Opportunity /> they cost.

Note:

- You can buy as much as you want and multiples of the same part, as long as you have the <Opportunity /> and <Money />. (The sum <Opportunity /> must be less than or equal to your <Roll /> roll and the sum <Money /> must be less than or equal to what you have in the AM column.)
- Cells are prefixed by their mathematical operation. You're spending <Money /> and <Opportunity />, so those they have a "**-**". You're gaining parts, so those cells have a "**+**". The same corresponding **-**/**+** signs are in the Actions table.
- Unused cells have a gray background to denote they're skipped.
- Cells with no change can be crossed out or filled with 0.
- You can spend less <Opportunity /> than you roll, but you cannot spend more.
- You cannot spend more <Money /> than you have.

### 3. Make

Next, you'll use the parts you just bought to make widgets. Again, the Actions table lists what you can make, their <Opportunity /> costs, and the parts that they'll consume:

<ActionsTable actions={[ACTIONS.MAKE]} className={styles.ActionsTable} />

Again, only use the outlined <Opportunity /> values for now.

{/* - <AB />: Amplifier
- <ABC />: Boombox
- <ABCD />: Game */}

To complete the Make phase:

1. **Roll for <Opportunity />:** Roll a die. Its value is the _maximum_ <Opportunity /> you can spend making.
1. **Decide:** Based on which parts you now have available and the max <Opportunity /> you just rolled, decide which widgets to make.
1. **Write:** In the Make column, write the values for the parts you used, the widgets you made, and the total <Opportunity /> they cost.

Just like in the Buy phase, you can make as much as you want, provided you have the parts and <Opportunity />.

### 4. Sell

If you made any widgets, now's the time to sell them. Note how the Actions table has you losing widgets but now gaining <Money />:

<ActionsTable actions={[ACTIONS.SELL]} className={styles.ActionsTable} />

To complete the Sell phase:

1. **Roll for <Opportunity />:** Roll a die. Its value is the _maximum_ <Opportunity /> you can spend selling.
1. **Decide:** Based on which widgets you made in the previous turn and the max <Opportunity /> you just rolled, decide which widgets to sell.
1. **Write:** In the Sell column, write the values for the <Money /> you made, the widgets you sold, and the total total <Opportunity /> they cost.

### 5. PM

Time to wrap the day up and end the turn.

To complete the PM phase:

1. **Tally:** Complete each row's equation into the final column prefixed with **=**.
1. **Resolve <Opportunity />:**
   - If <Opportunity /> is negative, you suffer **Burnout** and lose the entire next turn to rest.
   - Otherwise, **Roll for research**. Its value is the <Opportunity /> cost it would take to upgrade _one_ of the previous three actions: Buying, Making, or Selling.
1. **Plot:** Draw a dot on the "Money / Turn" chart at your new <Money /> total, then draw a line connecting it to the previous dot.

#### Burnout

Cross out the entire next turn's spreadsheet. You cannot do any of its actions.

#### Research Upgrade

Did you roll less than or equal to your remaining <Opportunity />? Congrats! Your research succeeded. Circle the cell to mark its success; otherwise cross it out to say it failed.

{/* TODO: circle/cross examples */}

(Note that the <Opportunity /> roll for research is used differently than Buy/Make/Sell. For the other actions, it's a maximum that want to roll high; for research, it's more like a minimum that want to roll low.)

Recall how you've only been using the first column of <Opportunity /> values with the dark outline. If your research succeeded, choose _one_ action to spend it on, then cross its column out and outline the values to their right.

As an example, here's what it would look like to successfully research Making:

<ActionsTable className={styles.ActionsTable} selectedIndexes={[0, 1, 0]} />

The non-researched action's <Opportunity /> costs remain unchanged.

## Example turn

{/* TODO: successful research w/ circle */}

Here's an example of a completed first turn:

<Turn
  className={styles.Turn}
  data={{
    money: [10, 5, undefined, 6, 11],
    A: [0, 1, 1, undefined, 0],
    B: [0, 2, 1, undefined, 1],
    C: [0, 0, 0, undefined, 0],
    D: [0, 0, 0, undefined, 0],
    AB: [0, undefined, 1, 1, 0],
    ABC: [0, undefined, 0, 0, 0],
    ABCD: [0, undefined, 0, 0, 0],
    opportunity: [12, 2, 1, 2, 8],
  }}
  suppliedColumns={firstTurnSuppliedColumns}
/>

## Ending a turn

When your turn's done, hand the die to the next player so they can start their turn.

## Starting a new turn

The values in your PM column carry over to the empty cells in the next turn's AM column, as denoted by their "**â‡¢**" prefix.

Note that <Opportunity /> is _not_ empty; you have to use the value provided.

## End of the Game

The player with the most money at the end of the six turns _without_ Burning Out in the last turn wins! Unused parts and unsold widgets count for nothing, only money.

If you **Burnout** in the last turn, you automatically lose.

{/* TODO: reconsider or houserule */}

## Solo Mode

Solo play is solitaire; try to beat your best score.

## Icon Glossary

##### Parts

<table>
  <tbody>
    <tr><th><A /></th><td>Gear</td></tr>
    <tr><th><B /></th><td>Enclosure</td></tr>
    <tr><th><C /></th><td>Controls</td></tr>
    <tr><th><D /></th><td>Processor</td></tr>
  </tbody>
</table>

##### Widgets

<table>
  <tbody>
    <tr><th><AB /></th><td>Speaker</td></tr>
    <tr><th><ABC /></th><td>Boombox</td></tr>
    <tr><th><ABCD /></th><td>Game</td></tr>
  </tbody>
</table>

##### Other

<table>
  <tbody>
    <tr><th><Money /></th><td>Money</td></tr>
    <tr><th><Opportunity /></th><td>Opportunity</td></tr>
    <tr><th><Roll /></th><td>Roll</td></tr>
  </tbody>
</table>

## Credits

Hardware Hustle was designed by Oskitone, maker of DIY electronic musical instruments and soldering kits.

It has a CC BY-SA 4.0 license; its entire source code can be downloaded at github.com/oskitone/hardware_hustle

Draft icons are from Bootstrap and Ionicons, both MIT licensed.

Please support Oskitone by buying your next synthtesizer project from oskitone.com.

---

_{props.draftId}_  
_{props.year} CC BY-SA 4.0 - oskitone.com_

export default function Rules({ children, page, pageCount, year, draftId }) {
  return (
    <div className={
        classnames(
          styles.rules, {
            [styles["view-all"]]: page == undefined
          }
        )
    }>
      <div className={classnames(styles.pageNumber, {
        [styles.front]: page % 2 == 0,
        [styles.back]: page % 2 == 1
      })}>{page + 1}/{pageCount}</div>
      <div className={styles.inner} page={page}>
        {children}
      </div>
    </div>
  );

}
